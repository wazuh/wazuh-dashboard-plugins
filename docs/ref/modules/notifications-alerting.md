# Notifications and Alerts in the Dashboard

This document presents Notifications and Alerts as native capabilities of the Wazuh Dashboard. It explains what they provide to the user, how they are initialized through the Dashboard Health Check, and the recommended steps to achieve a functional, stable, and verifiable configuration.

**Operational note**: the Health Check executes tasks with the Dashboard internal user. Any persistent object it creates (channels, monitors, etc.) is stored in the `Global` tenant. For general information, see [Health Check](./healthcheck.md) in Dashboard management.

## Concepts

- **Notifications**: allow you to define output channels (for example, Slack, PagerDuty, Jira, or Shuffle) to which the Dashboard will send messages generated by system actions.
- **Alerts**: allow you to define monitors that query Wazuh data and execute actions when conditions are met; among those actions, sending notifications to configured channels.

These functions are part of the Dashboard and may be available depending on the platform installation and configuration.

## Related Health Check Task

The Health Check includes a specific task that streamlines the setup of these capabilities:

- **Task name**: `notification-channel:default-channels-integrations`.
- **Function**: verifies the existence of default notification channels and creates them if missing. If the Alerts component is available, it also attempts to create sample monitors pointing to those channels.
- **Creation state**: channels and monitors created by this task are left disabled to facilitate review and configuration before activation.

For general Health Check details, see [Health Check](./healthcheck.md).

## Default Notification Channels Created

When the Notifications functionality is available in the Dashboard, the Health Check creates (if they don't exist) the following channels. All are created disabled:

- **Slack Channel**: requires a Slack Incoming Webhook URL with the format `https://hooks.slack.com/services/...`. How to obtain it: see the official Slack guide on [Incoming Webhooks](https://api.slack.com/messaging/webhooks). After creating the app and enabling Webhooks, Slack will display the specific URL for your workspace and channel.
- **PagerDuty Channel**: uses Events API v2 at `https://events.pagerduty.com/v2/enqueue`. You must provide your Integration Key in the `X-Routing-Key` header.
- **Jira Channel**: creates issues using the Jira REST API. You must specify your instance URL and the `Authorization: Basic <base64(email:api_token)>` header.
- **Shuffle Channel**: sends messages to a Shuffle workflow Webhook. You must specify the webhook URL for the corresponding workflow.

Security recommendations: treat these URLs and credentials as secrets. Review permissions and channel visibility before enabling it.

## Sample Monitors Created

If the Alerts functionality is available, the Health Check attempts to create the following sample monitors on the Wazuh alerts index pattern (`wazuh-alerts-*`):

| Monitor name        | Target channel    | Behavior                                                     |
| ------------------- | ----------------- | ------------------------------------------------------------ |
| `Sample: Slack`     | Slack Channel     | Queries for general alerts and sends notifications to Slack. |
| `Sample: PagerDuty` | PagerDuty Channel | Sends sample events to PagerDuty via Events v3.              |
| `Sample: Jira`      | Jira Channel      | Triggers a mock issue creation.                              |
| `Sample: Shuffle`   | Shuffle Channel   | Sends a test payload to the Shuffle workflow.                |

> If a required channel does **not** exist, the monitor will **not** be created.

You can review the created monitors under `Explore â†’ Alerting â†’ Monitors`.
For more information about monitor configuration, see the official OpenSearch documentation:
ðŸ”— [OpenSearch Alerting Monitors Documentation](https://docs.opensearch.org/latest/observing-your-data/alerting/monitors/)

## Steps to Complete the Configuration

1. Configure and enable the notification channel

   - Go to `Explore > Notifications > Channels` and open one of the default channels (Slack, PagerDuty, Jira, or Shuffle).
   - Provide the required endpoint or credentials, replacing the placeholders with real values:
     - **Slack**: specify the Incoming Webhook URL obtained from your Slack workspace.
     - **PagerDuty**: keep the default URL and set your Integration Key in the `X-Routing-Key` header.
     - **Jira**: specify your instance URL and configure `Authorization: Basic <base64(email:api_token)>`.
     - **Shuffle**: specify the Webhook URL of the workflow you will use.
   - Save and unmuted/enable the channel when the test is successful.

   Test notes:
   - **Slack**: you can validate the channel by sending a test message from the Notifications interface.
   - **Jira** and **PagerDuty**: effective validation is performed by executing the action from a monitor (see point 2). This is the recommended way to confirm delivery.

2. Connect and enable the sample monitors

   - Go to `Explore > Alerting > Monitors` and open the corresponding `Sample: <Channel>` monitor.
   - If it has no action, add "Send notification" and select the previously configured channel; if it already exists, verify that it points to the correct channel.
   - Adjust the subject/message template if necessary and enable the monitor.

3. Run the Health Check again

   - Open `Dashboard management > Health Check` and run the checks. Once channels and monitors are enabled, the related checks should pass to a healthy state.

## Enable Only Notification Checks

To exclusively enable notification-related checks through configuration:

```yml
healthcheck.checks_enabled: 'notification-channel'
```

Or, to explicitly target the task described above:

```yml
healthcheck.checks_enabled: 'notification-channel:default-channels-integrations'
```

## Logs and Troubleshooting

The Health Check logs detailed progress information during verification and setup.
Examples of log entries include:

```
server    log   [15:03:45.031] [info][healthcheck][notification-channel:default-channels-integrations] All default notification channels are now present and verified
server    log   [15:18:45.030] [info][healthcheck][notification-channel:default-channels-integrations] Starting Alerting sample monitors check
server    log   [15:18:45.041] [info][healthcheck][notification-channel:default-channels-integrations] Monitor already exists [Sample: Slack]
server    log   [15:18:44.971] [info][healthcheck][notification-channel:default-channels-integrations] Starting verification of default notification channels
```

If a check fails, review these log entries for details on which resource was missing or misconfigured.

## Useful Links and References

- [Health Check](./healthcheck.md).
- Slack â€“ [Incoming Webhooks](https://api.slack.com/messaging/webhooks): official guide to create and obtain the URL.
- Monitors - [opensearch](https://docs.opensearch.org/latest/observing-your-data/alerting/monitors/)
