{
  "index_patterns": ["wazuh-states-sca*"],
  "priority": 1,
  "template": {
    "settings": {
      "index": {
        "number_of_replicas": "0",
        "number_of_shards": "1",
        "refresh_interval": "5s",
        "query.default_field": [
          "agent.id",
          "agent.name",
          "agent.version",
          "agent.host.architecture",
          "agent.host.ip",
          "check.id",
          "check.name",
          "check.description",
          "check.result",
          "policy.id",
          "policy.name",
          "policy.file",
          "checksum.hash.sha1",
          "wazuh.cluster.name",
          "wazuh.cluster.node",
          "wazuh.schema.version"
        ]
      }
    },
    "mappings": {
      "dynamic": "strict",
      "date_detection": false,
      "properties": {
        "agent": {
          "properties": {
            "id": { "type": "keyword", "ignore_above": 1024 },
            "name": { "type": "keyword", "ignore_above": 1024 },
            "version": { "type": "keyword", "ignore_above": 1024 },
            "host": {
              "properties": {
                "architecture": { "type": "keyword", "ignore_above": 1024 },
                "ip": { "type": "ip" }
              }
            }
          }
        },
        "check": {
          "properties": {
            "id": { "type": "keyword", "ignore_above": 1024 },
            "name": { "type": "keyword", "ignore_above": 1024 },
            "description": { "type": "keyword", "ignore_above": 1024 },
            "rationale": { "type": "keyword", "ignore_above": 1024 },
            "condition": { "type": "keyword", "ignore_above": 1024 },
            "result": { "type": "keyword", "ignore_above": 1024 },
            "reason": { "type": "keyword", "ignore_above": 1024 },
            "remediation": { "type": "keyword", "ignore_above": 1024 },
            "references": { "type": "keyword", "ignore_above": 1024 },
            "rules": { "type": "keyword", "ignore_above": 1024 },
            "compliance": { "type": "keyword", "ignore_above": 1024 }
          }
        },
        "policy": {
          "properties": {
            "id": { "type": "keyword", "ignore_above": 1024 },
            "name": { "type": "keyword", "ignore_above": 1024 },
            "file": { "type": "keyword", "ignore_above": 1024 },
            "description": { "type": "keyword", "ignore_above": 1024 },
            "references": { "type": "keyword", "ignore_above": 1024 }
          }
        },
        "checksum": {
          "properties": {
            "hash": {
              "properties": {
                "sha1": { "type": "keyword", "ignore_above": 1024 }
              }
            }
          }
        },
        "wazuh": {
          "properties": {
            "cluster": {
              "properties": {
                "name": { "type": "keyword", "ignore_above": 1024 },
                "node": { "type": "keyword", "ignore_above": 1024 }
              }
            },
            "schema": {
              "properties": {
                "version": { "type": "keyword", "ignore_above": 1024 }
              }
            }
          }
        }
      }
    }
  }
}
