# ğŸ§ª **Jest Unit Testing Workflow**
#
# âš¡ **Overview:**
# This GitHub Action runs Jest unit tests on the applicationâ€™s source code.
# It ensures that code changes pass the defined test suites, maintaining code reliability and functionality.
#
# ğŸ› ï¸ **Key Features:**
# - ğŸ§¬ Runs Jest tests on specified Git references (branches, tags, or commit SHAs).
# - ğŸ”„ Supports manual execution with selectable test commands.
# - ğŸ“¦ Reuses the `5_builderprecompiled_base-dev-environment` workflow for consistent test environments.
# - ğŸ“Š Generates and notifies about Jest coverage summaries after execution.
#
# ğŸ”— Reference:
# - Jest: https://jestjs.io/

name: Run unit test

on:
  workflow_dispatch:
    inputs:
      reference:
        required: true
        type: string
        default: main
        description: Git reference (branch, tag, or commit SHA) to build from.
      command:
        required: true
        type: choice
        default: 'yarn test:jest'
        description: Select the test command to run.
        options:
          - 'yarn test:jest'
  pull_request:

concurrency:
  group: pr-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

jobs:
  # Run unit tests with Jest
  test:
    name: Run unit tests
    uses: ./.github/workflows/5_builderprecompiled_base-dev-environment.yml
    with:
      reference: ${{ github.event.inputs.reference }}
      command: ${{ github.event.inputs.command || 'yarn test:jest' }}
      notify_jest_coverage_summary: true
    secrets: inherit
