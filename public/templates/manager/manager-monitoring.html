<md-content flex layout="column" ng-if="submenuNavItem == 'monitoring'" ng-show="!isClusterEnabled" ng-controller="clusterController">
    <div flex layout="row" layout-align="start start">
        <md-card class="wz-md-card" flex>
            <md-card-content class="wz-text-center">
                <div layout="row" class="wz-padding-top-10">
                    <i class="fa fa-frown-o"></i> The cluster is disabled.
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <a href="https://documentation.wazuh.com/current/user-manual/manager/wazuh-cluster.html">https://documentation.wazuh.com/current/user-manual/manager/wazuh-cluster.html</a>
                </div>
            </md-card-content>
        </md-card>
    </div>
</md-content>
<md-content flex layout="column" ng-if="submenuNavItem == 'monitoring'" ng-show="isClusterEnabled" ng-controller="clusterController">
    <div layout="row" class="md-padding font-size-18 wz-margin-top-10" ng-if="!loading">
        <span flex="20" ng-if="!showConfig && !showNodes"><i class="fa fa-sitemap"></i> {{ currentAPI }}</span>
        <span flex ng-if="showConfig"><i class="fa fa-sitemap"></i> <span class="wz-text-link cursor-pointer" ng-click="goBack()">{{ currentAPI }}</span> / overview</span>
        <span flex ng-if="showNodes && !currentNode"><i class="fa fa-sitemap"></i> <span class="wz-text-link cursor-pointer" ng-click="goBack()">{{ currentAPI }}</span> / nodes</span>
        <span flex ng-if="currentNode"><i class="fa fa-sitemap"></i> <span class="wz-text-link cursor-pointer" ng-click="goBack()">{{ currentAPI }}</span> / <span class="wz-text-link cursor-pointer" ng-click="goNodes()">nodes</span> / {{ currentNode.name }}</span>
    </div>
    <div layout="row" ng-if="!showConfig && !showNodes && !loading">
        <md-card flex="50" class="wz-md-card">
            <md-card-content>
                <span class="wz-headline-title wz-text-link cursor-pointer" ng-click="goConfiguration()">Overview</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="40">IP</span>
                    <span flex class="color-grey">{{configuration.nodes[0] || 'Unknown'}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="40">Running</span>
                    <span flex class="color-grey">{{ status || 'no' }}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="40">Version</span>
                    <span flex class="color-grey">{{version}}</span>
                </div>
            </md-card-content>
        </md-card>
        <md-card flex="50" class="wz-md-card">
            <md-card-content>
                <span class="wz-headline-title">Info</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-padding-top-10 cursor-pointer" ng-click="goNodes()">
                    <span class="wz-text-link" flex="40">Nodes</span>
                    <span flex class="color-grey">{{nodesCount}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10 cursor-pointer" ng-click="goAgents()">
                    <span class="wz-text-link" flex="40">Agents</span>
                    <span flex class="color-grey">{{agentsCount}}</span>
                </div>
            </md-card-content>
        </md-card>
    </div>  

    <kbn-dis ng-if="!showNodes" ng-show="!loading && (!showNodes || currentNode)"></kbn-dis>

    <div layout="row" ng-show="showConfig" class="wz-timelions">
        <md-card flex="30" class="wz-md-card" ng-show="rendered">
            <md-card-content class="wazuh-column">
                <span class="wz-headline-title">Top nodes</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis vis-id="'Wazuh-App-Cluster-Overview-Node-Pie'" id="Wazuh-App-Cluster-Overview-Node-Pie"></kbn-vis>
            </md-card-content>
        </md-card>
        <md-card flex class="wz-md-card">
            <md-card-content>
                <span class="wz-headline-title">Overview</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Disabled</span>
                    <span flex class="color-grey">{{configuration.disabled}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Hidden</span>
                    <span flex class="color-grey">{{configuration.hidden}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Name</span>
                    <span flex class="color-grey">{{configuration.name}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Node name</span>
                    <span flex class="color-grey">{{configuration.node_name}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Node type</span>
                    <span flex class="color-grey">{{configuration.node_type}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Bind address</span>
                    <span flex class="color-grey">{{configuration.bind_addr}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">IP</span>
                    <span flex class="color-grey">{{configuration.nodes[0] || 'Unknown'}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="15">Port</span>
                    <span flex class="color-grey">{{configuration.port}}</span>
                </div>
            </md-card-content>
        </md-card>

    </div>


    <div layout="column" flex ng-if="showNodes">
        <md-card flex class="wz-md-card" ng-show="!currentNode">
            <md-card-content >
                <span class="wz-headline-title">Nodes</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <wz-search-bar class="wz-lateral-padding-16" data="nodes" term="nodeSearchTerm" placetext="'Filter nodes...'"></wz-search-bar>

                <wz-table-header
                    layout="row"
                    data="nodes"
                    keys="[
                        {name:'Name',size:25},
                        {name:'Version',size:25},
                        {name:'IP',size:25},
                        {name:'Type',size:25}
                    ]"
                    >
                </wz-table-header>
                <wz-table
                    layout="column"
                    flex
                    data="nodes"
                    func="showNode(index)"
                    keys="[
                        {col:'name',size:25},
                        {col:'version',size:25},
                        {col:'ip',size:25},
                        {col:'type',size:25}
                    ]"
                    class="no-lateral-padding"
                >
                </wz-table>
            </md-card-content>
        </md-card>
        <kbn-dis ng-show="!loading && !showConfig && (!showNodes || currentNode)"></kbn-dis>

        <div class="wazuh-loading" layout="column" layout-align="center center" ng-show="resultState === 'ready' && !rendered && currentNode && !loading && !showConfig">
            <div class="percentage"><i class="fa fa-spinner fa-spin fa-fw" aria-hidden="true"></i></div>
            <div class="percentage">{{loadingStatus}}</div>
        </div>
        <div layout="row" class="height-250 wz-timelions" ng-show="currentNode && !loading && !showConfig">
            <md-card flex class="wz-md-card" >
                <md-card-content class="wazuh-column">
                    <span class="wz-headline-title">{{ currentNode.name }} alerts summary</span>
                    <md-divider class="wz-margin-top-10"></md-divider>
                    <kbn-vis ng-show="rendered" vis-id="'Wazuh-App-Cluster-Overview-Node'" id="Wazuh-App-Cluster-Overview-Node"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>

        <div layout="row" ng-show="currentNode && currentNode.healthCheck && currentNode.healthCheck">

        <md-card flex layout="column" class="wz-md-card" ng-show="currentNode && currentNode.healthCheck && currentNode.healthCheck.info">
            <md-card-content>
                <span class="wz-headline-title">Info</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="20">IP</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.info.ip}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="20">Version</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.info.version}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="20">Type</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.info.type}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="20">Name</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.info.name}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="20">Active agents</span>
                    <span flex class="color-grey">{{ currentNode.healthCheck.info.n_active_agents }}</span>
                </div>
            </md-card-content>
        </md-card>

            <md-card layout="column" flex class="wz-md-card" ng-show="currentNode && currentNode.healthCheck && currentNode.healthCheck.status">
                    <md-card-content>
                        <span class="wz-headline-title">Last files integrity synchronization</span>
                        <md-divider class="wz-margin-top-10"></md-divider>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex="30">Date start master</span>
                            <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_integrity.date_start_master}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex="30">Date end master</span>
                            <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_integrity.date_end_master}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex="30">Total shared files</span>
                            <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_integrity.total_files.shared}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex="30">Total missing files</span>
                            <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_integrity.total_files.missing}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex="30">Total extra but valid files</span>
                            <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_integrity.total_files.extra_valid}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex="30">Total extra files</span>
                            <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_integrity.total_files.extra}}</span>
                        </div>
                    </md-card-content>
                </md-card>
            </div>

        <div layout="row" ng-show="currentNode && currentNode.healthCheck && currentNode.healthCheck.status">
                <md-card layout="column" flex class="wz-md-card" >
                        <md-card-content>
                            <span class="wz-headline-title">Last agents information synchronization</span>
                            <md-divider class="wz-margin-top-10"></md-divider>
                            <div layout="row" class="wz-padding-top-10">
                                <span flex="30">Date start master</span>
                                <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_agentinfo.date_start_master}}</span>
                            </div>
                            <div layout="row" class="wz-padding-top-10">
                                <span flex="30">Date end master</span>
                                <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_agentinfo.date_end_master}}</span>
                            </div>
                            <div layout="row" class="wz-padding-top-10">
                                <span flex="30">Total agent info</span>
                                <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_agentinfo.total_agentinfo}}</span>
                            </div>
                        </md-card-content>
                    </md-card>
        <md-card flex layout="column" class="wz-md-card" ng-show="currentNode && currentNode.healthCheck && currentNode.healthCheck.status">
            <md-card-content>
                <span class="wz-headline-title">Last agents groups synchronization</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="30">Date start master</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_agentgroups.date_start_master}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="30">Date end master</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_agentgroups.date_end_master}}</span>
                </div>
                <div layout="row" class="wz-padding-top-10">
                    <span flex="30">Total agent info</span>
                    <span flex class="color-grey">{{currentNode.healthCheck.status.last_sync_agentgroups.total_agentgroups}}</span>
                </div>
            </md-card-content>
        </md-card>

        </div>
    </div>

    <div layout="row" layout-align="center stretch" class="height-400 wz-timelions" ng-show="!loading && !showConfig && !showNodes">
        <md-card flex class="wz-md-card">
            <md-card-content class="wazuh-column">
                <span class="wz-headline-title">Master alerts summary</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis specific-time-range="true" vis-id="'Wazuh-App-Cluster-Overview-Manager'" id="Wazuh-App-Cluster-Overview-Manager"></kbn-vis>
            </md-card-content>
        </md-card>
        <md-card flex class="wz-md-card">
            <md-card-content class="wazuh-column">
                <span class="wz-headline-title">Overall alerts summary</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis specific-time-range="true" vis-id="'Wazuh-App-Cluster-Overview'" id="Wazuh-App-Cluster-Overview"></kbn-vis>
            </md-card-content>
        </md-card>
    </div>
</md-content>