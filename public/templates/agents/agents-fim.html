<md-content flex layout="column" ng-if="tab === 'fim' && tabView === 'panels' && !showNewFim" ng-show="!showSyscheckFiles"
    ng-class="{'no-opacity': resultState === 'none' || !rendered}" layout-align="start">
    <div layout="row">
        <span flex></span>
        <md-button ng-click="launchSyscheckScan()" class="discoverSectionSwitchBtn pull-right"><i
                class="fa fa-fw fa-play"></i>
            Run
            scan</md-button>
        <span></span>
        <md-button ng-click="switchSyscheckFiles()" class="discoverSectionSwitchBtn pull-right"><i
                class="fa fa-fw fa-database"></i>
            Show files</md-button>
    </div>
</md-content>

<md-content flex layout="column" ng-if="tab === 'fim' && tabView === 'panels' && showSyscheckFiles"
    layout-align="start">
    <div layout="row" class="wz-padding-bottom-14 wz-padding-top-14">
        <span flex></span>
        <md-button ng-click="launchSyscheckScan()" class="discoverSectionSwitchBtn pull-right"><i
                class="fa fa-fw fa-play"></i>
            Run scan</md-button>
        <span></span>
        <md-button ng-click="switchSyscheckFiles()" class="discoverSectionSwitchBtn pull-right"><i
                class="fa fa-fw fa-area-chart"></i>
            Show alerts</md-button>
    </div>

    <div layout="row" class="wz-margin-top-10 wz-margin-right-8 wz-margin-left-8"
        ng-if="showSyscheckFiles && (!agent || !agent.os)">
        <div flex class="euiCallOut euiCallOut--warning">
            <div class="euiCallOutHeader">
                <react-component name="EuiIcon" props="{type:'help',className:'euiCallOutHeader__title'}" />
                <span class="euiCallOutHeader__title">This agent has never connected.</span>
            </div>
        </div>
    </div>

    <div layout="row" class="wz-padding-top-0" ng-if="agent && agent.os && agent.os.platform === 'windows'">
        <div class="euiPanel euiFlexItem wz-margin-10" flex="" class="wz-md-card _md flex">
            <md-card-content class="wz-padding-bottom-30">
                <span class="embPanel__header embPanel__title embPanel__dragger layout-row wz-headline-title"><i
                        class="fa fa-fw fa-windows"></i> Windows registry</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-margin-top-10">
                    <input placeholder="Filter registry..." ng-model="registrySearch" type="text"
                        class="kuiLocalSearchInput ng-empty ng-pristine ng-scope ng-touched ng-valid height-30"
                        aria-invalid="false"
                        wz-enter="searchSyscheckFile(registrySearch,{name:'type',value:'registry'})">
                    <button type="submit" aria-label="Search" class="kuiLocalSearchButton height-30"
                        ng-click="searchSyscheckFile(registrySearch,{name:'type',value:'registry'})">
                        <span class="fa fa-search" aria-hidden="true"></span>
                    </button>
                </div>
                <div layout="row" ng-if="agent && !load" class="wz-margin-top-10 wz-margin-bottom-40-inv">
                    <wz-table flex path="'/syscheck/' + agent.id" implicit-filter="[{name:'type',value:'registry'}]"
                        row-sizes="[6,6,6]" keys="['file']">
                    </wz-table>
                </div>
            </md-card-content>
            <md-card-actions layout="row" layout-align="end center" class="layout-align-end-center layout-row">

                <button type="button"
                    ng-click="downloadCsv('/syscheck/' + agent.id, 'fim-registry.csv', [{name:'type',value:'registry'}])"
                    class="euiButtonEmpty euiButtonEmpty--primary euiButtonEmpty--small">
                    <span class="euiButtonEmpty__content">
                        <react-component name="EuiIcon" props="{type:'importAction'}" />
                        <span class="euiButtonEmpty__text">Formatted</span>
                    </span>
                </button>
            </md-card-actions>
        </div>
    </div>

    <div layout="row" class="wz-padding-top-0" ng-if="agent && agent.os && agent.os.platform === 'windows'">
        <div class="euiPanel euiFlexItem wz-margin-10" flex="" class="wz-md-card _md flex">
            <md-card-content class="wz-padding-bottom-30">
                <span class="embPanel__header embPanel__title embPanel__dragger layout-row wz-headline-title"><i
                        class="fa fa-fw fa-file-o"></i> Files</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-margin-top-10">
                    <input placeholder="Filter files..." ng-model="filesSearch" type="text"
                        class="kuiLocalSearchInput ng-empty ng-pristine ng-scope ng-touched ng-valid height-30"
                        aria-invalid="false" wz-enter="searchSyscheckFile(filesSearch,{name:'type',value:'file'})">
                    <button type="submit" aria-label="Search" class="kuiLocalSearchButton height-30"
                        ng-click="searchSyscheckFile(filesSearch,{name:'type',value:'file'})">
                        <span class="fa fa-search" aria-hidden="true"></span>
                    </button>
                </div>
                <div layout="row" ng-if="agent && !load" class="wz-margin-top-10 wz-margin-bottom-40-inv">
                    <wz-table flex path="'/syscheck/' + agent.id" implicit-filter="[{name:'type',value:'file'}]"
                        row-sizes="[6,6,6]"
                        keys="['file',{value: 'size', width: '100px'},'uname','perm','sha256',{value: 'uid', width: '100px'},'mtime']">
                    </wz-table>
                </div>
            </md-card-content>
            <md-card-actions layout="row" layout-align="end center" class="layout-align-end-center layout-row">
                <button type="button"
                    ng-click="downloadCsv('/syscheck/' + agent.id, 'fim-files.csv', [{name:'type',value:'file'}])"
                    class="euiButtonEmpty euiButtonEmpty--primary euiButtonEmpty--small">
                    <span class="euiButtonEmpty__content">
                        <react-component name="EuiIcon" props="{type:'importAction'}" />
                        <span class="euiButtonEmpty__text">Formatted</span>
                    </span>
                </button>
            </md-card-actions>
        </div>
    </div>

    <div layout="row" class="wz-margin-10" ng-if="agent && agent.os && agent.os.platform !== 'windows'">
        <react-component name="SyscheckTable" props="syscheckTableProps" />
    </div>
</md-content>

<div ng-if="tab === 'fim' && tabView === 'panels' && showNewFim">
    <div ng-if="agent && agent.os">
        <react-component name="MainFim" props="fimProps"/>
    </div>
</div>