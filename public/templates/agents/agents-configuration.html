<md-content flex layout="column" ng-if="tab === 'configuration' && configurationError" layout-align="start">

    <!-- <div class='uil-ring-css' ng-show="resultState === 'loading' && tabView === 'panels'"><div></div></div> -->

    <!-- View: Panels -->
    <div layout="column" layout-align="start stretch">
        <md-card flex>
            <md-card-content>
                <div layout="row">
                    <div flex>
                        <h4>
                            <i class="fa fa-warning"></i> This agent has never been connected, therefore no group has been assigned.</h4>
                    </div>
                </div>
                <div layout="row">
                    <div flex>
                        <p>Use the following links to learn about the agent registration process and grouping of agents:
                        </p>
                        <ul>
                            <li>
                                <a href="https://documentation.wazuh.com/current/user-manual/registering/index.html">https://documentation.wazuh.com/current/user-manual/registering/index.html</a>
                            </li>
                            <li>
                                <a href="https://documentation.wazuh.com/current/user-manual/agents/grouping-agents.html">https://documentation.wazuh.com/current/user-manual/agents/grouping-agents.html</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </md-card-content>
        </md-card>
    </div>
</md-content>

<!--jesus-->
<md-content flex layout="column" ng-if="tab === 'configuration' && !configurationError" layout-align="start">
    <div flex layout="column" layout-align="start stretch" ng-init="showRaw=false">
        <div flex layout="row">
            <md-card flex>
                <div layout="row" class="md-padding">
                    <h1 flex="90" ng-show="!load" class="md-title">Current group:
                        <span ng-click="goGroup()" class="agents-head-5 blue">{{groupName}}</span>
                        <md-tooltip md-direction="bottom">Click to go to the group details</md-tooltip>
                        - Configuration status:
                        <span ng-class="isSynchronized ? 'green' : 'red'" class="agents-head-5">{{isSynchronized ? 'SYNCHRONIZED' : 'NOT SYNCHRONIZED'}}</span>
                    </h1>
                    <md-switch flex="10" ng-model="toggleRAW">View JSON</md-switch>
                </div>
                <md-card-content ng-show="!toggleRAW" ng-init="configTab='fim'">
                    <md-nav-bar md-selected-nav-item="configTab">
                        <md-nav-item md-nav-click="switchConfigTab('fim')" name="fim">
                            File Integrity
                        </md-nav-item>
                        <md-nav-item md-nav-click="switchConfigTab('pm')" name="pm">
                            Policy Monitoring
                        </md-nav-item>
                        <md-nav-item md-nav-click="switchConfigTab('log')" name="log">
                            Log Collection
                        </md-nav-item>
                    </md-nav-bar>
                </md-card-content>

                <!-- No config -->
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="!groupConfiguration.config.syscheck && configTab==='fim'">
                    <div flex>
                        <h1 class="md-title text-center">No FIM configuration available</h1>
                        <p class="text-center">There's no FIM group configuration used for this agent.</p>
                    </div>
                </div>
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="!groupConfiguration.config.rootcheck && configTab==='pm'">
                    <div flex>
                        <h1 class="md-title text-center">No PM configuration available</h1>
                        <p class="text-center">There's no PM group configuration used for this agent.</p>
                    </div>
                </div>
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="!groupConfiguration.config['localfile'] && configTab==='log'">
                    <div flex>
                        <h1 class="md-title text-center">No Log Collection configuration available</h1>
                        <p class="text-center">There's no Log Collection group configuration used for this agent.</p>
                    </div>
                </div>
                <!-- End no config -->

                <!-- FIM -->
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="groupConfiguration.config.syscheck && configTab==='fim' && !toggleRAW">
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4><i class="fa fa-tasks"></i> Main Settings</h4>
                                <md-divider></md-divider>
                                <p ng-if="groupConfiguration.config.syscheck.disabled">
                                    Disabled
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.disabled}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.frequency">
                                        Frequency
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.frequency}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.alert_new_files">
                                        Alert New Files
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.alert_new_files}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.skip_nfs">
                                        Skip NFS
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.skip_nfs}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.scan_on_start">
                                        Scan on Start
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.scan_on_start}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.scan_time">
                                        Scan Time
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.scan_time}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.scan_day">
                                        Scan Day
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.scan_day}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.syscheck.auto_ignore">
                                        Auto Ignore
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.syscheck.auto_ignore}}</span>
                                </p>
                            </div>
                        </div>
                    </md-card>
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4><i class="fa fa-file-o"></i> Monitored files</h4>
                                <md-divider></md-divider>
                                <div ng-repeat="item in groupConfiguration.config.syscheck.directories">
                                    <p ng-if="item.path">
                                        Path <span class="md-secondary pull-right">{{item.path}}</span>
                                    </p>
                                    <p ng-if="item.check_all">
                                        Check All <span class="md-secondary pull-right">{{item.check_all}}</span>
                                    </p>
                                    <p ng-if="item.realtime">
                                        Realtime <span class="md-secondary pull-right">{{item.realtime}}</span>
                                    </p>
                                    <p ng-if="item.report_changes">
                                        Report Changes <span class="md-secondary pull-right">{{item.report_changes}}</span>
                                    </p>
                                    <md-divider ng-if="!$last"></md-divider>
                                </div>
                            </div>
                        </div>
                    </md-card>
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4><i class="fa fa-file"></i> Ignored files</h4>
                                <md-divider></md-divider>
                                <div ng-repeat="item in groupConfiguration.config.syscheck.ignore">
                                    <p ng-if="!item.type">
                                        File <span class="md-secondary pull-right">{{item}}</span>
                                    </p>
                                    <p ng-if="item.type">
                                        File <span class="md-secondary pull-right">{{item.item}}</span>
                                    </p>
                                    <p ng-if="item.type">
                                        Type <span class="md-secondary pull-right">{{item.type}}</span>
                                    </p>
                                    <md-divider ng-if="!$last"></md-divider>
                                </div>
                            </div>
                        </div>  
                    </md-card>
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4><i class="fa fa-clone"></i> No diff</h4>
                                <md-divider></md-divider>
                                <div ng-repeat="item in groupConfiguration.config.syscheck.nodiff">
                                    <p ng-if="!item.type">
                                        File <span class="md-secondary pull-right">{{item}}</span>
                                    </p>
                                    <p ng-if="item.type">
                                        File <span class="md-secondary pull-right">{{item.item}}</span>
                                    </p>
                                    <p ng-if="item.type">
                                        Type <span class="md-secondary pull-right">{{item.type}}</span>
                                    </p>
                                    <md-divider ng-if="!$last"></md-divider>
                                </div>
                            </div>
                        </div>  
                    </md-card>
                </div>
                <!-- End FIM -->

                <!-- PM -->
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="groupConfiguration.config.rootcheck && configTab==='pm' && !toggleRAW">
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4><i class="fa fa-tasks"></i> Main Settings</h4>
                                <md-divider></md-divider>
                                <p ng-if="groupConfiguration.config.rootcheck.disabled">
                                        Disabled
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.disabled}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.base_directory">
                                        Base directory
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.base_directory}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.frequency">
                                        Frequency
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.frequency}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.scanall">
                                        Scan All Files
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.scanall}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.skip_nfs">
                                        Skip NFS
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.skip_nfs}}</span>
                                </p>
                            </div>
                        </div>
                    </md-card>
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4><i class="fa fa-windows"></i> Windows Settings</h4>
                                <md-divider></md-divider>
                                <p ng-if="groupConfiguration.config.rootcheck.check_winaudit">
                                        Check Windows Audit
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_winaudit}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_winapps">
                                        Check Windows Apps
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_winapps}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_winmalware">
                                        Check Windows Malware
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_winmalware}}</span>
                                </p>
                            </div>
                        </div>
                    </md-card>
                </div>
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="groupConfiguration.config.rootcheck && configTab==='pm' && !toggleRAW">
                    <md-card flex>
                        <div layout="row" class="md-padding">
                            <div flex>
                                <h4>
                                    <i class="fa fa-check"></i> Checks</h4>
                                <md-divider></md-divider>
                                <p ng-if="groupConfiguration.config.rootcheck.check_unixaudit">
                                    Check UNIX Audit
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_unixaudit}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_dev">
                                        Check DEV
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_dev}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_files">
                                        Check Files
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_files}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_if">
                                        Check IF
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_if}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_pids">
                                        Check PIDs
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_pids}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_policy">
                                        Check Policy
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_policy}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_ports">
                                        Check Ports
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_ports}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_sys">
                                        Check SYS
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_sys}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_trojans">
                                        Check Trojans
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_trojans}}</span>
                                </p>
                                <p ng-if="groupConfiguration.config.rootcheck.check_unixaudit">
                                        Check UNIX Audit
                                    <span class="md-secondary pull-right">{{groupConfiguration.config.rootcheck.check_unixaudit}}</span>
                                </p>
                            </div>
                        </div>
                    </md-card>
                </div>
                <!-- End PM -->

                <!-- Log -->
                <div layout="row" class="ownNavBarCluster topPaddingSearchNoBottom" ng-show="groupConfiguration.config['localfile'] && configTab==='log' && !toggleRAW">

                </div>
                <!-- End Log -->

                <!-- JSON -->
                <div layout="row" flex class="md-padding height-300 ownNavBarCluster topPaddingSearchNoBottom" ng-show="toggleRAW">
                    <pre flex layout-fill class="json-beautifier"><code dynamic="rawJSON"></code></pre>
                </div>
                <!-- End JSON -->


            </md-card>
        </div>
    </div>
</md-content>

<!--end jesus-->


<!--
                <md-tab flex label="Policy Monitoring">

                    <md-content ng-if="!groupConfiguration.config.rootcheck" class="md-padding background-f7">
                        <h1 class="md-title text-center">No PM configuration available</h1>
                        <p class="text-center">There's no PM group configuration used for this agent.</p>
                    </md-content>

                    <div ng-show="groupConfiguration.config.rootcheck" layout="row" layout-align="space-around" class="md-padding background-f7 agent-conf-panel">

                        <div flex="45" layout="column">

                            <div flex="auto" layout="row">

                                <div flex="auto" layout="column">





                                </div>

   

                            </div>

                            <md-card flex="auto">
                                <md-card-content class="wazuh-column">
                                    <span class="md-headline">Rootkit</span>
                                    <md-list class="md-dense">
                                        <md-list-item ng-if="groupConfiguration.config.rootcheck.rootkit_trojans">
                                            <p>
                                                <span class="text-bold">Trojans Path:</span> {{groupConfiguration.config.rootcheck.rootkit_trojans[0]}}</p>
                                        </md-list-item>
                                        <md-list-item ng-if="groupConfiguration.config.rootcheck.rootkit_files">
                                            <p>
                                                <span class="text-bold">Files Path:</span> {{groupConfiguration.config.rootcheck.rootkit_files[0]}}</p>
                                        </md-list-item>
                                    </md-list>
                                </md-card-content>
                            </md-card>

                        </div>

                        <div flex="auto" layout="column">

                            <md-card flex="auto">
                                <md-card-content class="wazuh-column">
                                    <span class="md-headline">System Audit Files</span>
                                    <md-list class="md-dense">
                                        <md-list-item ng-repeat="item in groupConfiguration.config.rootcheck.system_audit|orderBy">
                                            <div class="md-list-item-text" layout="column">
                                                <p>
                                                    <span class="text-bold">File:</span> {{item}}</p>
                                            </div>
                                            <md-divider ng-if="!$last"></md-divider>
                                        </md-list-item>
                                    </md-list>
                                </md-card-content>
                            </md-card>

                            <md-card flex="auto">
                                <md-card-content class="wazuh-column">
                                    <span class="md-headline">Windows Audit Files</span>
                                    <md-list class="md-dense">
                                        <md-list-item ng-repeat="item in groupConfiguration.config.rootcheck.windows_audit|orderBy">
                                            <div class="md-list-item-text" layout="column">
                                                <p>
                                                    <span class="text-bold">File:</span> {{item}}</p>
                                            </div>
                                            <md-divider ng-if="!$last"></md-divider>
                                        </md-list-item>
                                    </md-list>
                                </md-card-content>
                            </md-card>

                            <md-card flex="auto">
                                <md-card-content class="wazuh-column">
                                    <span class="md-headline">Windows Apps Files</span>
                                    <md-list class="md-dense">
                                        <md-list-item ng-repeat="item in groupConfiguration.config.rootcheck.windows_apps|orderBy">
                                            <div class="md-list-item-text" layout="column">
                                                <p>
                                                    <span class="text-bold">File:</span> {{item}}</p>
                                            </div>
                                            <md-divider ng-if="!$last"></md-divider>
                                        </md-list-item>
                                    </md-list>
                                </md-card-content>
                            </md-card>

                            <md-card flex="auto">
                                <md-card-content class="wazuh-column">
                                    <span class="md-headline">Windows Malware Files</span>
                                    <md-list class="md-dense">
                                        <md-list-item ng-repeat="item in groupConfiguration.config.rootcheck.windows_malware|orderBy">
                                            <div class="md-list-item-text" layout="column">
                                                <p>
                                                    <span class="text-bold">File:</span> {{item}}</p>
                                            </div>
                                            <md-divider ng-if="!$last"></md-divider>
                                        </md-list-item>
                                    </md-list>
                                </md-card-content>
                            </md-card>

                        </div>

                    </div>

                </md-tab>

                <md-tab label="Log Collection">

                    <md-content ng-if="!groupConfiguration.config['localfile']" class="md-padding background-f7">
                        <h1 class="md-title text-center">No Log Collection configuration available</h1>
                        <p class="text-center">There's no Log Collection group configuration used for this agent.</p>
                    </md-content>

                    <div ng-show="groupConfiguration.config['localfile']" layout="row" layout-align="space-around" class="md-padding background-f7 agent-conf-panel">
                        <md-card flex="auto">
                            <md-card-content class="wazuh-column">
                                <span class="md-headline">Log Files</span>
                                <md-list class="md-dense">
                                    <md-list-item ng-repeat="item in groupConfiguration.config['localfile']|orderBy">
                                        <div class="md-list-item-text" layout="column">
                                            <p ng-if="item.location">
                                                <span class="text-bold">Location:</span> {{item.location}}</p>
                                            <p ng-if="item.log_format">
                                                <span class="text-bold">Log Format:</span> {{item.log_format}}</p>
                                            <p ng-if="item.frequency">
                                                <span class="text-bold">Frequency:</span> {{item.frequency}}</p>
                                            <p ng-if="item.query">
                                                <span class="text-bold">Query:</span> {{item.query}}</p>
                                            <p ng-if="item.command">
                                                <span class="text-bold">Command:</span> {{item.command}}</p>
                                            <p ng-if="item.alias">
                                                <span class="text-bold">Alias:</span> {{item.alias}}</p>
                                            <p ng-if="item.only-future-events">
                                                <span class="text-bold">Only Future Events:</span> {{item.only-future-events}}</p>
                                            <p ng-if="item.label">
                                                <span class="text-bold">Label:</span> {{item.label}}</p>
                                        </div>
                                        <md-divider ng-if="!$last"></md-divider>
                                    </md-list-item>
                                </md-list>
                            </md-card-content>
                        </md-card>
                    </div>

                </md-tab>

                <!-- <md-tab label="Active Response">
                    <md-content ng-if="!groupConfiguration.config['active-response']" class="md-padding background-f7">
                        <h1 class="md-title text-center">No Active Response configuration available</h1>
                        <p class="text-center">There's no Active Response group configuration used for this agent.</p>
                    </md-content>
                    <md-content ng-if="groupConfiguration.config['active-response']" class="md-padding background-f7">
                        <span ng-repeat="item in groupConfiguration.config['active-response']|orderBy">
                            <span layout="row" layout-align="start">
                                <p>Active Response disabled:</p>
                                <p class="text-bold"> {{item.disabled}}</p>
                            </span>
                            <md-divider></md-divider>
                            <span layout="row" layout-align="start">
                                <p>Certificate Storage:</p>
                                <p class="text-bold"> {{item.ca_store}}</p>
                            </span>
                        </span>
                    </md-content>
                </md-tab>

                <md-tab label="OpenSCAP">
                    <md-content ng-if="!groupConfiguration.config['open-scap']" class="md-padding background-f7">
                        <h1 class="md-title text-center">No OpenSCAP configuration available</h1>
                        <p class="text-center">There's no OpenSCAP group configuration used for this agent.</p>
                    </md-content>
                    <md-content ng-if="groupConfiguration.config['open-scap']" class="md-padding background-f7">
                        <span layout="row" layout-align="start">
                            <p>OpenSCAP disabled:</p>
                            <p class="text-bold"> {{groupConfiguration.config['open-scap'].disabled}}</p>
                        </span>
                        <md-divider></md-divider>
                        <span layout="row" layout-align="start">
                            <p>Interval:</p>
                            <p class="text-bold"> {{groupConfiguration.config['open-scap'].interval}}</p>
                        </span>
                        <md-divider></md-divider>
                        <span layout="row" layout-align="start">
                            <p>Scan on start:</p>
                            <p class="text-bold"> {{groupConfiguration.config['open-scap'].scan-on-start}}</p>
                        </span>
                        <md-divider></md-divider>
                        <span layout="row" layout-align="start">
                            <p>CIS-CAT Path:</p>
                            <p class="text-bold"> {{groupConfiguration.config['open-scap'].ciscat_path}}</p>
                        </span>
                        <md-divider></md-divider>
                        <span layout="row" layout-align="start">
                            <p>Java Path:</p>
                            <p class="text-bold"> {{groupConfiguration.config['open-scap'].java_path}}</p>
                        </span>
                        <md-divider></md-divider>
                        <span layout="row" layout-align="start">
                            <p>Timeout:</p>
                            <p class="text-bold"> {{groupConfiguration.config['open-scap'].timeout}}</p>
                        </span>
                    </md-content>
                </md-tab> -->

<!--</md-tabs>

            <md-content id="agent-conf-raw-panel" flex layout="row" class="md-padding background-f7" ng-show="toggleRAW">
                <div layout="row">
                    <pre flex layout-fill class="json-beautifier"><code dynamic="rawJSON"></code></pre>
                </div>
            </md-content>
        </md-card>
    </div>
</md-content>-->