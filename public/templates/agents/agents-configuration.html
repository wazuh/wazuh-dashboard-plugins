<md-content flex layout="column" ng-if="tab === 'configuration' && configurationError" layout-align="start">

    <!-- Loading ring -->
    <div class='uil-ring-css' ng-show="load">
        <div></div>
    </div>

    <!-- View: Panels -->
    <div layout="column" layout-align="start stretch" ng-show="!load">
        <md-card flex class="wz-md-card">
            <md-card-content>
                <span class="wz-headline-title"><i class="fa fa-fw fa-warning"></i> Warning</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-padding-top-10 wz-line-height">
                    This agent has never been connected, therefore no group has been assigned.
                </div>
                <div layout="row" class="wz-padding-top-10 wz-line-height">
                    Use the following links to learn about the agent registration process and grouping of agents:
                </div>
                <div layout="row" class="wz-padding-top-10 wz-line-height">
                    <ul>
                        <li>
                            <a href="https://documentation.wazuh.com/current/user-manual/registering/index.html">https://documentation.wazuh.com/current/user-manual/registering/index.html</a>
                        </li>
                        <li>
                            <a href="https://documentation.wazuh.com/current/user-manual/agents/grouping-agents.html">https://documentation.wazuh.com/current/user-manual/agents/grouping-agents.html</a>
                        </li>
                    </ul>
                </div>
            </md-card-content>
        </md-card>
    </div>

</md-content>

<md-content flex layout="column" ng-if="tab === 'configuration' && !configurationError" layout-align="start">

    <!-- Loading ring -->
    <div class='uil-ring-css' ng-show="load">
        <div></div>
    </div>

    <!-- The section container -->
    <div flex layout="column" layout-align="start stretch" ng-init="showRaw=false; selectedConfigTab='fim'" ng-show="!load">

        <!-- First row - Configuration status and other details -->
        <div layout="row">
            <md-card flex class="wz-metric-color wz-md-card">
                <md-card-content layout="row" class="wz-padding-metric">
                    <div flex>Group: <span ng-click="goGroup()" class="wz-font-weight-bold cursor-pointer" tooltip="Click to go to the group details" tooltip-placement="right">{{groupName}} <i class="fa fa-eye"></i></span></div>
                    <div flex>Configuration status: <span class="wz-font-weight-bold" tooltip="The current synchronization status" tooltip-placement="right">{{isSynchronized ? 'SYNCHRONIZED' : 'NOT SYNCHRONIZED'}}</span></div>
                </md-card-content>
            </md-card>
        </div>

        <!-- Second row - The configuration section itself -->
        <div layout="row">

            <div flex="25">

                <!-- FILE INTEGRITY -->
                <md-card flex class="wz-md-card">
                    <md-card-content>
                        <!-- Section title -->
                        <span class="wz-headline-title cursor-pointer" tooltip="Click to see more details" tooltip-placement="right" ng-click="selectedConfigTab='fim'">
                            File Integrity <i class="fa fa-eye"></i>
                        </span>
                        <md-divider class="wz-margin-top-10"></md-divider>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex>View File Integrity settings</span>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END FILE INTEGRITY -->

                <!-- POLICY MONITORING -->
                <md-card flex class="wz-md-card">
                    <md-card-content>
                        <!-- Section title -->
                        <span class="wz-headline-title cursor-pointer" tooltip="Click to see more details" tooltip-placement="right" ng-click="selectedConfigTab='pm'">
                            Policy Monitoring <i class="fa fa-eye"></i>
                        </span>
                        <md-divider class="wz-margin-top-10"></md-divider>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex>View Policy Monitoring settings</span>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END POLICY MONITORING -->

                <!-- LOG COLLECTION -->
                <md-card flex class="wz-md-card">
                    <md-card-content>
                        <!-- Section title -->
                        <span class="wz-headline-title cursor-pointer" tooltip="Click to see more details" tooltip-placement="right" ng-click="selectedConfigTab='log'">
                            Log Collection <i class="fa fa-eye"></i>
                        </span>
                        <md-divider class="wz-margin-top-10"></md-divider>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex>View Log Collection settings</span>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END LOG COLLECTION -->

                <!-- OPENSCAP -->
                <md-card flex class="wz-md-card">
                    <md-card-content>
                        <!-- Section title -->
                        <span class="wz-headline-title cursor-pointer" tooltip="Click to see more details" tooltip-placement="right" ng-click="selectedConfigTab='scap'">
                            OpenSCAP <i class="fa fa-eye"></i>
                        </span>
                        <md-divider class="wz-margin-top-10"></md-divider>
                        <div layout="row" class="wz-padding-top-10">
                            <span flex>View OpenSCAP settings</span>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END OPENSCAP -->

            </div>

            <div flex="75" layout="row" layout-align="start stretch">

                <!-- FILE INTEGRITY -->
                <md-card flex class="wz-md-card" ng-show="selectedConfigTab === 'fim' && !toggleRAW">
                    <md-card-content>

                        <!-- Section title -->
                        <div layout="row" layout-align="start center">
                            <span flex="85" class="wz-headline-title"><i class="fa fa-fw fa-shield"></i> File Integrity</span>
                            <md-switch flex="15" class="wz-md-switch" ng-model="toggleRAW">View JSON</md-switch>
                        </div>

                        <md-divider class="wz-margin-top-10"></md-divider>

                        <!-- No configuration panel -->
                        <div layout="column" ng-show="!groupConfiguration.config.syscheck">
                            <h1 flex class="md-title text-center wz-padding-top-10">No FIM configuration available</h1>
                            <p flex class="text-center wz-padding-top-10">There's no FIM group configuration used for this agent.</p>
                        </div>

                        <!-- Main settings -->
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.disabled">
                            <span flex>Disabled</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.disabled}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.frequency">
                            <span flex>Frrequency</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.frequency}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.alert_new_files">
                            <span flex>Alert new files</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.alert_new_files}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.skip_nfs">
                            <span flex>Skip NFS</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.skip_nfs}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.scan_on_start">
                            <span flex>Scan on start</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.scan_on_start}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.scan_time">
                            <span flex>Scan time</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.scan_time}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.scan_day">
                            <span flex>Scan day</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.scan_day}}</span>
                        </div>
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.auto_ignore">
                            <span flex>Auto ignore</span>
                            <span flex class="text-right color-grey">{{groupConfiguration.config.syscheck.auto_ignore}}</span>
                        </div>

                        <!-- No diff settings -->
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.nodiff">
                            <span class="wz-headline-title wz-padding-top-10">No diff</span>
                        </div>
                        <div ng-repeat="item in groupConfiguration.config.syscheck.nodiff">
                            <div ng-if="!item.type" layout="row" class="wz-padding-top-10">
                                <span flex>File</span>
                                <span flex class="text-right color-grey">{{item}}</span>
                            </div>
                            <div ng-if="item.type" layout="row" class="wz-padding-top-10">
                                <span flex>File</span>
                                <span flex class="text-right color-grey">{{item.item}}</span>
                            </div>
                            <div ng-if="item.type" layout="row" class="wz-padding-top-10">
                                <span flex>Type</span>
                                <span flex class="text-right color-grey">{{item.type}}</span>
                            </div>
                            <md-divider class="wz-margin-top-10" ng-if="!$last"></md-divider>
                        </div>

                        <!-- Monitored files -->
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.directories">
                            <span class="wz-headline-title wz-padding-top-10">Monitored files</span>
                        </div>
                        <div ng-repeat="item in groupConfiguration.config.syscheck.directories">
                            <div ng-if="item.path" layout="row" class="wz-padding-top-10">
                                <span flex>Path</span>
                                <span flex class="text-right color-grey">{{item.path}}</span>
                            </div>
                            <div ng-if="item.check_all" layout="row" class="wz-padding-top-10">
                                <span flex>Check all</span>
                                <span flex class="text-right color-grey">{{item.check_all}}</span>
                            </div>
                            <div ng-if="item.realtime" layout="row" class="wz-padding-top-10">
                                <span flex>Realtime</span>
                                <span flex class="text-right color-grey">{{item.realtime}}</span>
                            </div>
                            <div ng-if="item.report_changes" layout="row" class="wz-padding-top-10">
                                <span flex>Report changes</span>
                                <span flex class="text-right color-grey">{{item.report_changes}}</span>
                            </div>
                            <md-divider class="wz-margin-top-10" ng-if="!$last"></md-divider>
                        </div>

                        <!-- Ignored files -->
                        <div layout="row" class="wz-padding-top-10" ng-if="groupConfiguration.config.syscheck.ignore">
                            <span class="wz-headline-title wz-padding-top-10">Ignored files</span>
                        </div>
                        <div ng-repeat="item in groupConfiguration.config.syscheck.ignore">
                            <div ng-if="!item.type" layout="row" class="wz-padding-top-10">
                                <span flex>File</span>
                                <span flex class="text-right color-grey">{{item}}</span>
                            </div>
                            <div ng-if="item.type" layout="row" class="wz-padding-top-10">
                                <span flex>File</span>
                                <span flex class="text-right color-grey">{{item.item}}</span>
                            </div>
                            <div ng-if="item.type" layout="row" class="wz-padding-top-10">
                                <span flex>Type</span>
                                <span flex class="text-right color-grey">{{item.type}}</span>
                            </div>
                            <md-divider class="wz-margin-top-10" ng-if="!$last"></md-divider>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END FILE INTEGRITY -->

                <!-- POLICY MONITORING -->
                <md-card flex class="wz-md-card" ng-show="selectedConfigTab === 'pm' && !toggleRAW">
                    <md-card-content>

                        <!-- Section title -->
                        <div layout="row" layout-align="start center">
                            <span flex="85" class="wz-headline-title"><i class="fa fa-fw fa-check"></i> Policy Monitoring</span>
                            <md-switch flex="15" class="wz-md-switch" ng-model="toggleRAW">View JSON</md-switch>
                        </div>

                        <md-divider class="wz-margin-top-10"></md-divider>

                        <!-- No configuration panel -->
                        <div layout="column" ng-show="!groupConfiguration.config.rootcheck">
                            <h1 flex class="md-title text-center wz-padding-top-10">No PM configuration available</h1>
                            <p flex class="text-center wz-padding-top-10">There's no PM group configuration used for this agent.</p>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END POLICY MONITORING -->

                <!-- LOG COLLECTION -->
                <md-card flex class="wz-md-card" ng-show="selectedConfigTab === 'log' && !toggleRAW">
                    <md-card-content>

                        <!-- Section title -->
                        <div layout="row" layout-align="start center">
                            <span flex="85" class="wz-headline-title"><i class="fa fa-fw fa-check"></i> Log Collection</span>
                            <md-switch flex="15" class="wz-md-switch" ng-model="toggleRAW">View JSON</md-switch>
                        </div>

                        <md-divider class="wz-margin-top-10"></md-divider>

                        <!-- No configuration panel -->
                        <div layout="column" ng-show="!groupConfiguration.config['localfile']">
                            <h1 flex class="md-title text-center wz-padding-top-10">No Log Collection configuration available</h1>
                            <p flex class="text-center wz-padding-top-10">There's no Log Collection group configuration used for this agent.</p>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END LOG COLLECTION -->

                <!-- OPENSCAP -->
                <md-card flex class="wz-md-card" ng-show="selectedConfigTab === 'scap' && !toggleRAW">
                    <md-card-content>

                        <!-- Section title -->
                        <div layout="row" layout-align="start center">
                            <span flex="85" class="wz-headline-title"><i class="fa fa-fw fa-check"></i> OpenSCAP</span>
                            <md-switch flex="15" class="wz-md-switch" ng-model="toggleRAW">View JSON</md-switch>
                        </div>

                        <md-divider class="wz-margin-top-10"></md-divider>

                        <!-- No configuration panel -->
                        <div layout="column" ng-show="!groupConfiguration.config['open-scap']">
                            <h1 flex class="md-title text-center wz-padding-top-10">No OpenSCAP configuration available</h1>
                            <p flex class="text-center wz-padding-top-10">There's no OpenSCAP group configuration used for this agent.</p>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END OPENSCAP -->

                <!-- JSON VIEWER -->
                <md-card flex class="wz-md-card" ng-show="toggleRAW">
                    <md-card-content>

                        <!-- Section title -->
                        <div layout="row" layout-align="start center">
                            <span flex="85" class="wz-headline-title"><i class="fa fa-fw fa-eye"></i> JSON viewer</span>
                            <md-switch flex="15" class="wz-md-switch" ng-model="toggleRAW">View JSON</md-switch>
                        </div>

                        <md-divider class="wz-margin-top-10"></md-divider>

                        <!-- JSON viewer -->
                        <div flex class="wz-padding-top-10">
                            <pre flex class="wz-pre json-beautifier jsonbeauty2 wz-overflow-y-auto"><code wz-dynamic="rawJSON"></code></pre>
                        </div>
                    </md-card-content>
                </md-card>
                <!-- END JSON VIEWER -->

            </div>

        </div>

    </div>
</md-content>
