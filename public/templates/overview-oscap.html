<md-content flex layout="column" ng-if="tab == 'oscap'" ng-controller="overviewOSCAPController" class="app-container wazuh-column" layout-align="start">

    <div class='uil-ring-css' ng-if="tabView == 'panels'" ng-show='!hideRing(14)'><div></div></div>

    <!-- Kibana search bar -->
    <!-- Local nav. -->
    <div ng-if="hideRing(14) && !loading" ng-controller="kibanaSearchbar">
        <kbn-top-nav name="overview_oscap" config="topNavMenu">
          <!-- Transcluded elements. -->
          <div data-transclude-slots>
            <!-- Title. -->

            <!-- Search. -->
            <div ng-show="chrome.getVisible()" class="fullWidth" data-transclude-slot="bottomRow">
              <query-bar
                query="state.query"
                app-name="'wazuh'"
                on-submit="updateQueryAndFetch($query)"
              >
              </query-bar>
            </div>
          </div>
        </kbn-top-nav>

        <!-- Filters. -->
        <filter-bar
          ng-show="showFilterBar()"
          state="state"
          index-patterns="indexPattern"
          ng-if="state.query.language === 'lucene'"
        ></filter-bar>
    </div>

    <!-- No results message -->
    <md-content flex layout="row" layout-align="start start" ng-show="!results && !loading" ng-if="tabView == 'panels' && hideRing(14)">
        <md-card flex layout="column">
            <md-card-content class="overview-oscap-no-results">
                No results for selected time interval
            </md-card-content>
        </md-card>
    </md-content>

    <!-- View: Discover -->
    <md-content class="overview-oscap-discover" flex layout="column" layout-align="start space-around" ng-if="tabView == 'discover'">
        <kbn-disfull table-height="1000px;" dis-a="(columns:!(_source),filters:!(),index:'wazuh-alerts-*',interval:auto,query:(query_string:(analyze_wildcard:!t,query:'*')),sort:!('@timestamp',desc))"
        dis-filter="rule.groups:oscap"
        infinite-scroll="true">
        </kbn-disfull>
    </md-content>

    <!-- View: Panels -->
    <div ng-show="hideRing(14) && results && !loading" ng-if="tabView == 'panels'" class="wazuh-column">

        <div layout="row" layout-align="center stretch" class="overview-oscap-top-row-div">
            <md-card flex="20">
                <md-card-content class="wazuh-column overview-oscap-top-row">
                    <div class="ng-binding">Last score</div>
                    <kbn-vis class="kbn-vis-value" vis-id="'Wazuh-App-Overview-OSCAP-Last-score'" id="Wazuh-App-Overview-OSCAP-Last-score"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="40">
                <md-card-content class="wazuh-column overview-oscap-top-row">
                    <div class="ng-binding">Last agent scanned</div>
                    <kbn-vis class="kbn-vis-value" vis-id="'Wazuh-App-Overview-OSCAP-Last-agent-scanned'" id="Wazuh-App-Overview-OSCAP-Last-agent-scanned"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="40">
                <md-card-content class="wazuh-column overview-oscap-top-row">
                    <div class="ng-binding">Last scan profile</div>
                    <kbn-vis class="kbn-vis-value" vis-id="'Wazuh-App-Overview-OSCAP-Last-scan-profile'" id="Wazuh-App-Overview-OSCAP-Last-scan-profile"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>

        <div layout="row" layout-align="center stretch" class="overview-oscap-pie-row">
            <md-card flex="25">
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Agents</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Agents'" id="Wazuh-App-Overview-OSCAP-Agents"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Profiles</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Profiles'" id="Wazuh-App-Overview-OSCAP-Profiles"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Content</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Content'" id="Wazuh-App-Overview-OSCAP-Content"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Severity</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Severity'" id="Wazuh-App-Overview-OSCAP-Severity"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>

        <div layout="row" layout-align="start stretch" class="overview-oscap-top-5-row">
            <md-card flex>
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Top 5 Agents - Severity high</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Top-5-agents-Severity-high'" id="Wazuh-App-Overview-OSCAP-Top-5-agents-Severity-high"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>

        <div layout="row" layout-align="center stretch" class="overview-oscap-top-10-row">
            <md-card flex="50">
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Top 10 - Alerts</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Top-10-alerts'" id="Wazuh-App-Overview-OSCAP-Top-10-alerts"></kbn-vis>
                </md-card-content>
            </md-card>

            <md-card flex="50">
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Top 10 - High risk alerts</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Top-10-high-risk-alerts'" id="Wazuh-App-Overview-OSCAP-Top-10-high-risk-alerts"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>

        <div layout="row" layout-align="center stretch" class="overview-oscap-score-row">
            <md-card flex="20">
                <md-card-content class="wazuh-column overview-oscap-score-item">
                    <div class="ng-binding">Highest score</div>
                    <kbn-vis class="kbn-vis-value" vis-id="'Wazuh-App-Overview-OSCAP-Highest-score'" id="Wazuh-App-Overview-OSCAP-Highest-score"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="20">
                <md-card-content class="wazuh-column overview-oscap-score-item">
                    <div class="ng-binding">Lowest score</div>
                    <kbn-vis class="kbn-vis-value" vis-id="'Wazuh-App-Overview-OSCAP-Lowest-score'" id="Wazuh-App-Overview-OSCAP-Lowest-score"></kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="60">
                <md-card-content class="wazuh-column overview-oscap-score-item">
                    <div class="ng-binding">Latest alert</div>
                    <kbn-vis class="kbn-vis-value" vis-id="'Wazuh-App-Overview-OSCAP-Latest-alert'" id="Wazuh-App-Overview-OSCAP-Latest-alert"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>

        <div layout="row" layout-align="center stretch" class="overview-oscap-last-alerts">
            <md-card flex>
                <md-card-content class="wazuh-column">
                    <span class="md-headline">Last alerts</span>
                    <kbn-vis vis-id="'Wazuh-App-Overview-OSCAP-Last-alerts'" id="Wazuh-App-Overview-OSCAP-Last-alerts"></kbn-vis>
                </md-card-content>
            </md-card>
        </div>
    </div>
</md-content>

<style>
    .overview-oscap-no-results {
        text-align: center;
    }
    .overview-oscap-discover {
        background-color: white;
    }
    .overview-oscap-top-row-div {
        height: 100px;
    }
    .overview-oscap-top-row {
        text-align: center;
    }
    .overview-oscap-pie-row {
        height: 215px;
    }
    .overview-oscap-top-5-row {
        height: 240px;
    }
    .overview-oscap-top-10-row {
        height: 320px;
    }
    .overview-oscap-last-alerts {
        height: 530px;
    }
    .overview-oscap-score-row {
        height: 100px;
    }
    .overview-oscap-score-item {
        text-align: center;
    }
</style>